!function(w,d){const StorageNamespace={namespace:"localStorageManager",setNamespace(ns){this.namespace=ns},_getKey(key){return`${this.namespace}:${key}`},setItem(key,value){localStorage.setItem(this._getKey(key),JSON.stringify(value))},getItem(key){const item=localStorage.getItem(this._getKey(key));try{return JSON.parse(item)}catch(e){return console.error(`Error parsing JSON for key "${key}":`,e),null}},clear(){Object.keys(localStorage).forEach((key=>{key.startsWith(`${this.namespace}:`)&&localStorage.removeItem(key)}))},keys(){return Object.keys(localStorage).filter((key=>key.startsWith(`${this.namespace}:`))).map((key=>key.replace(`${this.namespace}:`,"")))},appendItem(key,value){const existingValue=this.getItem(key);if(Array.isArray(existingValue))existingValue.push(value),this.setItem(key,existingValue);else if(existingValue&&"object"==typeof existingValue)this.setItem(key,{...existingValue,...value});else{const newValue=Array.isArray(value)?value:[value];this.setItem(key,newValue)}},removeItem(key,index){const array=this.getItem(key);Array.isArray(array)&&array.length>index&&(array.splice(index,1),this.setItem(key,array))}},fileInput=d.getElementById("file-input"),checkboxes=d.getElementById("check-boxes"),selection=d.getElementById("select"),choice=d.getElementById("choices"),createLink=d.getElementById("create-link"),outputs=d.getElementById("output"),closeEx=d.getElementById("exit"),closeBtn=d.getElementById("exit1"),opensBtn=d.getElementById("open"),addition=d.getElementById("additions"),search=d.getElementById("site-search"),copyAll=d.getElementById("copy-links"),exportJson=d.getElementById("export-json"),showExport=d.getElementById("export-div"),links=d.getElementById("links"),found=d.getElementById("founded"),checked=d.getElementsByName("check")[0],filteredExport=d.getElementById("filter");checked.checked=!1,filteredExport.checked=!1;let lastElem=null,active=!1;const hide=element=>{lastElem&&lastElem!==element&&(lastElem.style.display="none",active=!1),element.style.display=active?"none":"block",active=!active,lastElem=element},counterObject={counter:w.localStorage.length,array:[]},showStats=()=>{found.innerHTML=`${counterObject.counter}/${counterObject.array.length}`},addTextOfChecked=m=>{choice.innerHTML=m||loopOverInputs().join(", ")},loopOverInputs=()=>[...checkboxes.getElementsByTagName("INPUT")].map((e=>{if(e.checked)return e.value})).filter(Boolean);function loopStorageItems(){const data=[],urls=StorageNamespace.getItem("url");return urls&&"object"==typeof urls&&Object.values(urls).forEach((value=>{data.push(value)})),data}const exporter=()=>{const fileName=`localStorage${function(){const dateObj=new Date,month=(dateObj.getUTCMonth()+1).toString().length>1?dateObj.getUTCMonth()+1:"0"+(dateObj.getUTCMonth()+1),day=dateObj.getUTCDate().toString().length>1?dateObj.getUTCDate():"0"+dateObj.getUTCDate(),year=dateObj.getUTCFullYear(),sec=dateObj.getSeconds().toString().length>1?dateObj.getSeconds():"0"+dateObj.getSeconds(),minutes=dateObj.getMinutes().toString().length>1?dateObj.getMinutes():"0"+dateObj.getMinutes(),hours=dateObj.getHours().toString().length>1?dateObj.getHours():"0"+dateObj.getHours();return`${year}-${month}-${day}(${hours}-${minutes}-${sec})`}()}.json`;if(filteredExport.checked){const filteredLinks=Array.from(outputs.querySelectorAll("a:not(.hidden)")).map((element=>element.links));saveData(filteredLinks,`${search.value||"fil"}-${fileName}`)}else{const allLinks=loopStorageItems();saveData(allLinks,`all-${fileName}`)}hide(showExport)};const remover=function(e){e.preventDefault();const index=counterObject.array.indexOf(this);-1!==index&&counterObject.array.splice(index,1),this.parentElement&&this.parentElement.removeChild(this);const links=this.links;links&&links.full&&StorageNamespace.removeItem("url",index),counterObject.counter=StorageNamespace.keys().length,showStats()};function setLinks(){const urlInput=d.getElementById("urls"),url=urlInput.value.trim();if(0===url.length)return addTextOfChecked("No URL defined"),!1;if(StorageNamespace.getItem(url))return addTextOfChecked("Value already exists"),!1;const fav=function(url){try{return new URL(url).hostname.split(":")[0]}catch(error){return console.error("Invalid URL:",error.message),null}}(url),createLinkObject={text:addition.value,url:fav,full:url,type:loopOverInputs()},element=createElem(createLinkObject);return outputs.appendChild(element),StorageNamespace.appendItem("url",createLinkObject),counterObject.array.push(element),counterObject.counter=StorageNamespace.keys().length,showStats(),urlInput.value="",!1}class DOMElements{constructor(elementTag,className,item,functions){return this.element=document.createElement(elementTag),this.element.links=item,className&&(this.element.className=className),functions&&(this.element.onclick=remover.bind(functions)),item&&this.switcher(elementTag).call(this),this.element}switcher(element){return this.switcherTag[element]}}DOMElements.prototype.switcherTag={span:function(){this.element.textContent=this.element.links},a:function(){const links=this.element.links;links&&links.full&&(this.element.setAttribute("target","_blank"),this.element.setAttribute("href",links.full))},img:function(){const links=this.element.links;links&&links.url&&(this.element.setAttribute("alt",`${links.url}-${adder.counter++}`),this.element.src=`https://${links.url}/favicon.ico`,this.element.onerror=function(e){e.target.onerror=null,e.target.src="./favicon.ico"})}};const adder={counter:0};function createElem(elms){const aElement=new DOMElements("a","link",elms,null);return[elms&&new DOMElements("img","img",elms,null),elms?.url&&new DOMElements("span","urls",elms.url,null),elms?.text&&new DOMElements("span","texts",elms.text,null),elms?.type&&new DOMElements("span","types",elms.type,null),aElement&&new DOMElements("span","close","Ã—",aElement)].filter(Boolean).forEach((childElement=>aElement.appendChild(childElement))),outputs.appendChild(aElement),aElement}function loopLocalStorage(){search.focus(),search.value="",counterObject.array=loopStorageItems().map((e=>createElem(e))),showStats()}function isStringAndNotEmpty(value){return"string"==typeof value&&""!==value.trim()}function loopLocalStorageSearch(){counterObject.counter=0,counterObject.array.forEach((entry=>{const{type:type,url:url,full:full,text:text}=entry.links;if(isStringAndNotEmpty(full)){[...type.length?type.join().split():[],...isStringAndNotEmpty(text)?text.split():[],...isStringAndNotEmpty(url)?url.split():[],...full.split()].some((value=>value.toLowerCase().includes(search.value.toLowerCase())))?(counterObject.counter++,entry.className="link"):entry.className="link hidden"}})),showStats()}const saveData=(()=>{const a=d.createElement("a");return(data,fileName)=>{const json=JSON.stringify(data,null,2),blob=new Blob([json],{type:"application/json"}),url=URL.createObjectURL(blob);a.href=url,a.download=fileName,a.click(),URL.revokeObjectURL(url)}})();function readSingleFile(event){const file=event.target.files[0];if(!file)return;const reader=new FileReader;reader.onload=event=>{!function(data){try{const json=JSON.parse(data),currentItems=StorageNamespace.getItem("url")||[];for(currentItems.push(...json),StorageNamespace.setItem("url",currentItems),hide(showExport);outputs.firstChild;)outputs.firstChild.remove();loopLocalStorage(),counterObject.counter=StorageNamespace.keys().length,showStats()}catch(error){console.error("Error parsing JSON:",error)}}(event.target.result)},reader.readAsText(file)}exportJson.addEventListener("click",(()=>exporter())),checked.addEventListener("input",(()=>checked.checked?outputs.classList.add("checks"):outputs.classList.remove("checks"))),search.addEventListener("input",(e=>{e.target.value.trim().length>0&&loopLocalStorageSearch()})),closeEx.addEventListener("click",(()=>hide(showExport))),closeBtn.addEventListener("click",(()=>hide(links))),opensBtn.addEventListener("click",(()=>hide(links))),createLink.addEventListener("click",(()=>setLinks())),copyAll.addEventListener("click",(e=>hide(showExport))),fileInput.addEventListener("change",(e=>readSingleFile(e)),!1),search.addEventListener("keyup",(e=>function(event){const{key:key,target:target}=event,inputValue=target.value.trim();"Backspace"===key&&0===inputValue.length&&(loopLocalStorageSearch(),showStats()),"Enter"===key&&inputValue.length>0&&(event.preventDefault(),loopLocalStorageSearch(),outputs?.children.length&&outputs.firstElementChild.focus())}(e)),!0),d.addEventListener("keydown",(e=>function(event){const{key:key}=event;return"Enter"===key||active||search.focus(),!1}(e)),!0),d.addEventListener("click",(e=>function(e){const isCreateLinkClicked="create-link"===e.target.id,isSelectClicked="select"===e.target.id;if(!isCreateLinkClicked)if(isSelectClicked&&!selection.classList.contains("open"))selection.classList.add("open"),checkboxes.style.display="block";else{if("LABEL"===e.target.tagName||"INPUT"===e.target.tagName)return;selection.classList.remove("open"),checkboxes.style.display="none",addTextOfChecked("")}}(e))),search.addEventListener("dblclick",(function(){this.value="",loopLocalStorageSearch()})),loopLocalStorage()}(window,document);