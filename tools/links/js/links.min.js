(function(e,c){function E(){const a=[];[...u.getElementsByTagName("INPUT")].forEach(b=>{b.checked&&a.push(b.value)});return a}function v(a){J.innerHTML=a||E().join(", ")}function p(a){a.style.display="none"===a.style.display?(w=!0,"block"):(w=!1,"none")}function x(){const a=c.getElementById("urls").value;if(0<a.length){let b;b=-1<a.indexOf("//")?a.split("/")[2]:a.split("/")[0];b=b.split(":")[0];b=b.split("?")[0];return{text:K.value,url:b,g:a,type:E()}}v("No URL defined");return!1}function q(){k.focus();
k.value="";h.innerHTML="";let a=0;for(var b=0;b<e.localStorage.length;b++){const d=e.localStorage.key(b),f=y(d);if(null!==f){const {full:g,text:l,type:m,url:n}=f;d&&(a++,F(n,m,l,g))}}0===a&&(h.innerHTML="No links added...");h.appendChild(z);b=e.localStorage.length;A.innerHTML=`${a}/${a<b?a:b}`}function B(){h.innerHTML="";let a=0;for(let d=0;d<e.localStorage.length;d++){var b=e.localStorage.key(d);b=y(b);if(null!==b){const {full:f,text:g,type:l,url:m}=b;"undefined"!==typeof f&&-1<f.indexOf("http")&&
l.concat(g.split(),m.split(),f.split()).map(n=>!!n.toLowerCase().includes(k.value.toLowerCase())).includes(!0)&&(a++,F(m,l,g,f))}}h.appendChild(z);A.innerHTML=`${a}/${e.localStorage.length}`;0===a&&(h.innerHTML="No results...")}function y(a){try{return JSON.parse(e.localStorage.getItem(a))}catch(b){return console.error("Error parsing JSON:",b),null}}function F(a,b,d,f){const g=c.createElement("a"),l=c.createElement("span"),m=c.createElement("span"),n=c.createElement("span"),r=c.createElement("span");
r.className="close";r.innerHTML="\u00d7";r.onclick=()=>{e.localStorage.removeItem(g.href);B();return!1};g.setAttribute("href",f);g.setAttribute("target","_blank");l.textContent=b;n.textContent=a;m.textContent=d;n.className="urls";g.appendChild(n);g.appendChild(m);g.appendChild(l);g.appendChild(r);z.appendChild(g)}const u=c.getElementById("check-boxes"),C=c.getElementById("select"),J=c.getElementById("choises"),L=c.getElementById("create-link"),h=c.getElementById("outpus"),M=c.getElementById("exit"),
N=c.getElementById("exit1"),O=c.getElementById("open"),K=c.getElementById("aditions"),k=c.getElementById("site-search"),P=c.getElementById("copy-links"),Q=c.getElementById("export-json"),t=c.getElementById("export-div"),G=c.getElementById("links"),A=c.getElementById("founded"),z=c.createDocumentFragment(),D=c.getElementsByName("check")[0],H=c.getElementById("filter");let w=!1;D.checked=!1;H.checked=!1;D.addEventListener("input",()=>D.checked?h.classList.add("checks"):h.classList.remove("checks"));
k.addEventListener("keydown",a=>{if("Enter"===a.key&&0<a.target.value.length)a.preventDefault(),B(),h.children.length&&h.firstElementChild.focus();else if("Backspace"===a.key&&0===a.target.value.length)A.innerHTML="",q();else return!1},!0);c.addEventListener("keydown",a=>{"Enter"===a.key||w||k.focus();return!1},!0);k.addEventListener("input",a=>{0<=a.target.value.length&&B()});P.addEventListener("click",()=>{p(t)});const I=(()=>{const a=c.createElement("a");return(b,d)=>{b=JSON.stringify(b,null,2);
b=e.URL.createObjectURL(new e.Blob([b],{type:"octet/stream"}));a.href=b;a.download=d;a.click();e.URL.revokeObjectURL(b)}})();L.addEventListener("click",()=>{try{if("localStorage"in e){if(x()){const a=JSON.stringify(x().g).slice(1,-1),b=JSON.stringify(x());e.localStorage.setItem(a,b)}}else e.alert("no localStorage in window")}catch(a){console.error("localStorage error:",a)}q()});const R=()=>{const [...a]=h.getElementsByTagName("a");return a.map(b=>({text:b.children[1].innerText,url:b.children[0].innerText,
g:b.href,type:[b.children[2].innerText]}))};Q.addEventListener("click",()=>{var a=new Date;a=`localStorage${`${a.getUTCFullYear()}-${1<(a.getUTCMonth()+1).toString().length?a.getUTCMonth()+1:"0"+(a.getUTCMonth()+1)}-${1<a.getUTCDate().toString().length?a.getUTCDate():"0"+a.getUTCDate()}(${1<a.getHours().toString().length?a.getHours():"0"+a.getHours()}-${1<a.getMinutes().toString().length?a.getMinutes():"0"+a.getMinutes()}-${1<a.getSeconds().toString().length?a.getSeconds():"0"+a.getSeconds()})`}.json`;
if(H.checked)I(R(),`fil-${a}`);else{const b=[];for(let d=0;d<e.localStorage.length;d++)b.push(y(e.localStorage.key(d)));I(b,`all-${a}`)}p(t)});k.addEventListener("dblclick",q);c.addEventListener("click",function(a){"create-link"!==a.target.id&&("select"!==a.target.id||C.classList.contains("open")?"LABEL"!==a.target.tagName&&"INPUT"!==a.target.tagName&&(C.classList.remove("open"),u.style.display="none",v("")):(C.classList.add("open"),u.style.display="block"))});M.addEventListener("click",()=>p(t));
N.addEventListener("click",()=>p(G));O.addEventListener("click",()=>p(G));v("");q();c.getElementById("file-input").addEventListener("change",function(a){if(a=a.target.files[0]){var b=new e.FileReader;b.onload=d=>{try{const f=JSON.parse(d.target.result),g=f.length;for(d=0;d<g;d++)e.localStorage.setItem(f[d].full,JSON.stringify(f[d]));p(t);q()}catch(f){console.error("Error parsing JSON:",f)}};b.readAsText(a)}},!1)})(window,document);
