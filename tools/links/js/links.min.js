!function(e,t){"use strict";const n={namespace:"localStorageManager",setNamespace(e){this.namespace=e},_getKey(e){return`${this.namespace}:${e}`},setItem(t,n){e.localStorage.setItem(this._getKey(t),JSON.stringify(n))},getItem(t){const n=e.localStorage.getItem(this._getKey(t));if(null===n)return[];try{return JSON.parse(n)}catch(e){return console.error(`Error parsing JSON for key "${t}":`,e),null}},clear(){Object.keys(e.localStorage).forEach((t=>{t.startsWith(`${this.namespace}:`)&&e.localStorage.removeItem(t)}))},keys(){return Object.keys(e.localStorage).filter((e=>e.startsWith(`${this.namespace}:url`))).map((e=>e.replace(`${this.namespace}:url`,"")))},appendItem(e,t){const n=this.getItem(e);if(Array.isArray(n))n.push(t),this.setItem(e,n);else if(n&&"object"==typeof n)this.setItem(e,{...n,...t});else{const n=Array.isArray(t)?t:[t];this.setItem(e,n)}},removeItem(e,t){const n=this.getItem(e);Array.isArray(n)&&n.length>t&&(n.splice(t,1),this.setItem(e,n))}},r=t.body,s=t.getElementById("file-input"),l=t.getElementById("check-boxes"),i=t.getElementById("select"),a=t.getElementById("choices"),o=t.getElementById("create-link"),c=t.getElementById("output"),u=t.getElementById("exit"),g=t.getElementById("exit1"),m=t.getElementById("open"),d=t.getElementById("additions"),h=t.getElementById("site-search"),y=t.getElementById("copy-links"),f=t.getElementById("export-json"),p=t.getElementById("export-div"),I=t.getElementById("links"),E=t.getElementById("founded"),k=t.getElementsByName("check")[0],v=t.getElementById("filter"),L=!!n.getItem("admin-mode");k.checked=L,r.classList.toggle("checks",L);v.checked=!1;let B=null,S=!1;const w=e=>{B&&B!==e&&(B.style.display="none",S=!1),e.style.display=S?"none":"block",S=!S,B=e},b={counter:n.getItem("url").length,array:[]},$=()=>{E.innerHTML=b.array.filter((e=>"hidden"!==e.className)).length+"/"+n.getItem("url").length},N=e=>{a.innerHTML=e||A().join(", ")},A=()=>[...l.getElementsByTagName("INPUT")].map((e=>{if(e.checked)return e.value})).filter(Boolean);function U(){const e=[],t=n.getItem("url");return t&&"object"==typeof t&&Object.values(t).forEach((t=>{e.push(t)})),e}const C=()=>{const e=`localStorage${function(){const e=new Date,t=(e.getUTCMonth()+1).toString().length>1?e.getUTCMonth()+1:"0"+(e.getUTCMonth()+1),n=e.getUTCDate().toString().length>1?e.getUTCDate():"0"+e.getUTCDate(),r=e.getUTCFullYear(),s=e.getSeconds().toString().length>1?e.getSeconds():"0"+e.getSeconds(),l=e.getMinutes().toString().length>1?e.getMinutes():"0"+e.getMinutes(),i=e.getHours().toString().length>1?e.getHours():"0"+e.getHours();return`${r}-${t}-${n}(${i}-${l}-${s})`}()}.json`;if(v.checked){const t=Array.from(c.querySelectorAll("a:not(.hidden)")).map((e=>e.links));H(t,`${h.value||"fil"}-${e}`)}else{const t=U();H(t,`all-${e}`)}w(p)};const T=function(e){e.preventDefault();const t=this.element,r=b.array.indexOf(t);e.target.parentElement&&t.remove(),r>=0&&(b.array.splice(r,1),n.removeItem("url",r)),$()};function x(){const e=t.getElementById("urls"),r=e.value.trim();if(0===r.length)return N("No URL defined"),!1;if(n.getItem(r))return N("Value already exists"),!1;const s=function(e){try{return new URL(e).hostname.split(":")[0]}catch(e){return console.error("Invalid URL:",e.message),null}}(r),l={text:d.value,url:s,full:r,type:A()},i=M(l);return c.appendChild(i),n.appendItem("url",l),b.array.push(i),$(),e.value="",!1}class O{constructor(e,n,r,s){this.element=t.createElement(e),this.element.links=r,"string"==typeof e&&this.switcher(e),"string"==typeof n&&(this.element.className=n),s&&"object"==typeof s&&"close"===n&&(this.element.onclick=T.bind(s))}switcher(e){return this[e]()}span(){this.element.textContent=this.element.links}a(){const e=this.element.links;e&&e.full&&(this.element.setAttribute("target","_blank"),this.element.setAttribute("href",e.full))}img(){const e=this.element.links,t=new Image;e&&e.url&&(t.setAttribute("alt",`${e.url}-${j.counter++}`),t.setAttribute("loading","lazy"),t.src=`https://${e.url}/favicon.ico`,t.width=16,t.height=16,t.onerror=function(e){e.target.onerror=null,e.target.src="./favicon.ico"}),this.element=t}}const j={counter:0};function M(e){if(!e)return;const t=new O("a","link",e,null);return[e&&new O("img","img",e,null),e?.url&&new O("span","urls",e.url,null),e?.text&&new O("span","texts",e.text,null),e?.type&&new O("span","types",e.type,null),t&&new O("span","close","Ã—",t)].filter(Boolean).forEach((e=>t.element.appendChild(e.element))),c.appendChild(t.element),t.element}function R(){h.focus(),h.value="",b.array=U().map((e=>M(e))),$()}function J(e){return"string"==typeof e&&""!==e.trim()}function D(){const e=h.value.toLowerCase().trim();b.counter=0,b.array.forEach((t=>{const{type:n,url:r,full:s,text:l}=t.links;if(J(s)){const i=[...n,...J(l)?[l]:[],...J(r)?[r]:[],s].some((t=>t.toLowerCase().includes(e)));t.className=i?"link":"hidden",i&&b.counter++}})),$()}const H=(()=>{const e=t.createElement("a");return(t,n)=>{const r=JSON.stringify(t,null,2),s=new Blob([r],{type:"application/json"}),l=URL.createObjectURL(s);e.href=l,e.download=n,e.click(),URL.revokeObjectURL(l)}})();function _(e){const t=e.target.files[0];if(!t)return;const r=new FileReader;r.onload=e=>{!function(e){try{const t=JSON.parse(e);if(Array.isArray(t)){const e=n.getItem("url")||[];t.forEach((t=>{e.some((e=>e.full===t.full))||e.push(t)})),n.setItem("url",e),b.array=e}else console.warn("Parsed JSON is not an array:",t);for(w(p);c.firstChild;)c.firstChild.remove();R(),$()}catch(e){console.error("Error parsing JSON:",e)}}(e.target.result)},r.readAsText(t)}let K;var P,q;f.addEventListener("click",(()=>C())),k.addEventListener("input",(()=>(()=>{const e=Boolean(k.checked);r.classList.toggle("checks",e),n.setItem("admin-mode",e)})())),u.addEventListener("click",(()=>w(p))),g.addEventListener("click",(()=>w(I))),m.addEventListener("click",(()=>w(I))),o.addEventListener("click",(()=>x())),y.addEventListener("click",(e=>w(p))),s.addEventListener("change",(e=>_(e)),!1),t.addEventListener("keydown",(e=>function(e){if(!e)return;const{key:t}=e;return"Enter"===t||S||h.focus(),e?.target.value.trim().length>1&&1===b.counter&&c.querySelector("a:not(.hidden)").focus(),!1}(e)),!0),t.addEventListener("click",(e=>function(e){const t="create-link"===e.target.id,n="select"===e.target.id;if(!t)if(n&&!i.classList.contains("open"))i.classList.add("open"),l.style.display="block";else{if("LABEL"===e.target.tagName||"INPUT"===e.target.tagName)return;i.classList.remove("open"),l.style.display="none",N("")}}(e))),h.addEventListener("keyup",(P=()=>D(),q=200,(...e)=>{clearTimeout(K),K=setTimeout((()=>{P(...e)}),q)})),h.addEventListener("dblclick",(function(){0!==this.value.length&&(this.value="",D())})),R()}(window,document);
