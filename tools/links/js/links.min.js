(function(e,c){function E(){const a=[];[...u.getElementsByTagName("INPUT")].forEach(b=>{b.checked&&a.push(b.value)});return a}function v(a){J.innerHTML=a||E().join(", ")}function n(a){a.style.display="none"===a.style.display?(w=!0,"block"):(w=!1,"none")}function x(){const a=c.getElementById("urls").value;if(0<a.length){let b;b=-1<a.indexOf("//")?a.split("/")[2]:a.split("/")[0];b=b.split(":")[0];b=b.split("?")[0];return{text:K.value,url:b,g:a,type:E()}}v("No URL defined");return!1}function p(){m.focus();
m.value="";h.innerHTML="";let a=0;for(var b=0;b<e.localStorage.length;b++){var d=e.localStorage.key(b);d=y(d);if(null!==d){const {full:g,text:f,type:k,url:l}=d;console.log(l,k,f,g);a++;F(l,k,f,g)}}0===a&&(h.innerHTML="No links added...");h.appendChild(z);b=e.localStorage.length;A.innerHTML=`${a}/${a<b?a:b}`}function B(){h.innerHTML="";let a=0;for(let d=0;d<e.localStorage.length;d++){var b=e.localStorage.key(d);b=y(b);if(null!==b){const {full:g,text:f,type:k,url:l}=b;"undefined"!==typeof g&&-1<g.indexOf("http")&&
k.concat(f.split(),l.split(),g.split()).map(q=>!!q.toLowerCase().includes(m.value.toLowerCase())).includes(!0)&&(a++,F(l,k,f,g))}}h.appendChild(z);A.innerHTML=`${a}/${e.localStorage.length}`;0===a&&(h.innerHTML="No results...")}function y(a){try{return JSON.parse(e.localStorage.getItem(a))}catch(b){return console.error("Error parsing JSON:",b),null}}function F(a,b,d,g){const f=c.createElement("a"),k=c.createElement("span"),l=c.createElement("span"),q=c.createElement("span"),r=c.createElement("span");
r.className="close";r.innerHTML="\u00d7";r.onclick=()=>{e.localStorage.removeItem(f.href);B();return!1};f.setAttribute("href",g);f.setAttribute("target","_blank");k.textContent=b;q.textContent=a;l.textContent=d;q.className="urls";f.appendChild(q);f.appendChild(l);f.appendChild(k);f.appendChild(r);z.appendChild(f)}const u=c.getElementById("check-boxes"),C=c.getElementById("select"),J=c.getElementById("choises"),L=c.getElementById("create-link"),h=c.getElementById("outpus"),M=c.getElementById("exit"),
N=c.getElementById("exit1"),O=c.getElementById("open"),K=c.getElementById("aditions"),m=c.getElementById("site-search"),P=c.getElementById("copy-links"),Q=c.getElementById("export-json"),t=c.getElementById("export-div"),G=c.getElementById("links"),A=c.getElementById("founded"),z=c.createDocumentFragment(),D=c.getElementsByName("check")[0],H=c.getElementById("filter");let w=!1;D.checked=!1;H.checked=!1;D.addEventListener("input",()=>D.checked?h.classList.add("checks"):h.classList.remove("checks"));
m.addEventListener("keydown",a=>{if("Enter"===a.key&&0<a.target.value.length)a.preventDefault(),B(),h.children.length&&h.firstElementChild.focus();else if("Backspace"===a.key&&0===a.target.value.length)A.innerHTML="",p();else return!1},!0);c.addEventListener("keydown",a=>{"Enter"===a.key||w||m.focus();return!1},!0);m.addEventListener("input",a=>{0<=a.target.value.length&&B()});P.addEventListener("click",()=>{n(t)});const I=(()=>{const a=c.createElement("a");return(b,d)=>{b=JSON.stringify(b,null,2);
b=e.URL.createObjectURL(new e.Blob([b],{type:"octet/stream"}));a.href=b;a.download=d;a.click();e.URL.revokeObjectURL(b)}})();L.addEventListener("click",()=>{try{if("localStorage"in e){if(x()){const a=JSON.stringify(x().g).slice(1,-1),b=JSON.stringify(x());e.localStorage.setItem(a,b)}}else e.alert("no localStorage in window")}catch(a){console.error("localStorage error:",a)}p()});const R=()=>{const [...a]=h.getElementsByTagName("a");return a.map(b=>({text:b.children[1].innerText,url:b.children[0].innerText,
g:b.href,type:[b.children[2].innerText]}))};Q.addEventListener("click",()=>{var a=new Date;a=`localStorage${`${a.getUTCFullYear()}-${1<(a.getUTCMonth()+1).toString().length?a.getUTCMonth()+1:"0"+(a.getUTCMonth()+1)}-${1<a.getUTCDate().toString().length?a.getUTCDate():"0"+a.getUTCDate()}(${1<a.getHours().toString().length?a.getHours():"0"+a.getHours()}-${1<a.getMinutes().toString().length?a.getMinutes():"0"+a.getMinutes()}-${1<a.getSeconds().toString().length?a.getSeconds():"0"+a.getSeconds()})`}.json`;
if(H.checked)I(R(),`fil-${a}`);else{const b=[];for(let d=0;d<e.localStorage.length;d++)b.push(y(e.localStorage.key(d)));I(b,`all-${a}`)}n(t)});m.addEventListener("dblclick",p);c.addEventListener("click",function(a){"create-link"!==a.target.id&&("select"!==a.target.id||C.classList.contains("open")?"LABEL"!==a.target.tagName&&"INPUT"!==a.target.tagName&&(C.classList.remove("open"),u.style.display="none",v("")):(C.classList.add("open"),u.style.display="block"))});M.addEventListener("click",()=>n(t));
N.addEventListener("click",()=>n(G));O.addEventListener("click",()=>n(G));v("");p();c.getElementById("file-input").addEventListener("change",function(a){if(a=a.target.files[0]){var b=new e.FileReader;b.onload=d=>{try{const g=JSON.parse(d.target.result),f=g.length;for(d=0;d<f;d++)e.localStorage.setItem(g[d].full,JSON.stringify(g[d]));n(t);p()}catch(g){console.error("Error parsing JSON:",g)}};b.readAsText(a)}},!1)})(window,document);
