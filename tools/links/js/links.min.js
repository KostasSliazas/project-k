!function(e,t){const n=t.getElementById("file-input"),l=t.getElementById("check-boxes"),r=t.getElementById("select"),i=t.getElementById("choices"),o=t.getElementById("create-link"),s=t.getElementById("output"),c=t.getElementById("exit"),a=t.getElementById("exit1"),u=t.getElementById("open"),g=t.getElementById("additions"),d=t.getElementById("site-search"),h=t.getElementById("copy-links"),f=t.getElementById("export-json"),m=t.getElementById("export-div"),y=t.getElementById("links"),p=t.getElementById("founded"),E=t.getElementsByName("check")[0],k=t.getElementById("filter");E.checked=!1,k.checked=!1;let v=null,S=!1;const L=e=>{v&&v!==e&&(v.style.display="none",S=!1),e.style.display=S?"none":"block",S=!S,v=e},I={counter:e.localStorage.length,array:[]},w=()=>{p.innerHTML=`${I.counter}/${I.array.length}`},B=e=>{i.innerHTML=e||C().join(", ")},C=()=>[...l.getElementsByTagName("INPUT")].map((e=>{if(e.checked)return e.value})).filter(Boolean);function N(e){try{const t=window.localStorage.getItem(e);return JSON.parse(t)}catch(t){return console.error("Error retrieving item from local storage:",t),null}}function U(){const t=[];for(let n=0;n<e.localStorage.length;n++)t.push(N(e.localStorage.key(n)));return t}const T=()=>{const e=`localStorage${function(){const e=new Date,t=(e.getUTCMonth()+1).toString().length>1?e.getUTCMonth()+1:"0"+(e.getUTCMonth()+1),n=e.getUTCDate().toString().length>1?e.getUTCDate():"0"+e.getUTCDate(),l=e.getUTCFullYear(),r=e.getSeconds().toString().length>1?e.getSeconds():"0"+e.getSeconds(),i=e.getMinutes().toString().length>1?e.getMinutes():"0"+e.getMinutes(),o=e.getHours().toString().length>1?e.getHours():"0"+e.getHours();return`${l}-${t}-${n}(${o}-${i}-${r})`}()}.json`;if(k.checked){const t=Array.from(s.querySelectorAll("a.displayed")).map((e=>e.links));J(t,`${d.value||"fil"}-${e}`)}else{const t=U();J(t,`all-${e}`)}L(m)};const $=function(t){t.preventDefault();const n=I.array.indexOf(this);-1!==n&&I.array.splice(n,1),this.parentElement&&this.parentElement.removeChild(this);const l=this.links;l&&l.full&&e.localStorage.removeItem(l.full),I.counter=e.localStorage.length,w()};function x(){const n=t.getElementById("urls"),l=n.value.trim();if(0===l.length)return B("No URL defined"),!1;if(e.localStorage.getItem(l))return B("Value already exists"),!1;const r=function(e){try{return new URL(e).hostname.split(":")[0]}catch(t){return console.error("Invalid URL:",t.message),null}}(l),i={text:g.value,url:r,full:l,type:C()},o=M(i);return s.appendChild(o),function(t){try{if("localStorage"in e){if(t){const n=JSON.stringify(t.full).slice(1,-1),l=JSON.stringify(t);e.localStorage.setItem(n,l)}}else e.alert("localStorage is not supported in this window.")}catch(n){return console.error("localStorage error:",n),null}}(i),I.array.push(o),I.counter=e.localStorage.length,w(),n.value="",!1}class b{constructor(e,t,n,l){return this.element=document.createElement(e),this.element.links=n,t&&(this.element.className=t),l&&(this.element.onclick=$.bind(l)),n&&this.switcher(e).call(this),this.element}switcher(e){return this.switcherTag[e]}}b.prototype.switcherTag={span:function(){this.element.textContent=this.element.links},a:function(){const e=this.element.links;e&&e.full&&(this.element.setAttribute("target","_blank"),this.element.setAttribute("href",e.full))},img:function(){const e=this.element.links;e&&e.url&&(this.element.setAttribute("alt",`${e.url}-${O.counter++}`),this.element.src=`https://${e.url}/favicon.ico`,this.element.onerror=function(e){e.target.onerror=null,e.target.src="./favicon.ico"})}};const O={counter:0};function M(e){const t=new b("a","link",e,null);return[new b("img","img",e,null),new b("span","urls",e.url,null),new b("span","texts",e.text,null),new b("span","types",e.type,null),new b("span","close","Ã—",t)].forEach((e=>t.appendChild(e))),s.appendChild(t),t}function R(){d.focus(),d.value="",I.array=U().map((e=>M(e))),w()}function j(e){return"string"==typeof e&&""!==e.trim()}function A(){I.counter=0,I.array.forEach((e=>{const{type:t,url:n,full:l,text:r}=e.links;if(j(l)){[...t.length?t.join().split():[],...j(r)?r.split():[],...j(n)?n.split():[],...l.split()].some((e=>e.toLowerCase().includes(d.value.toLowerCase())))?(I.counter++,e.className="link"):e.className="link hidden"}})),w()}const J=(()=>{const e=t.createElement("a");return(t,n)=>{const l=JSON.stringify(t,null,2),r=new Blob([l],{type:"application/json"}),i=URL.createObjectURL(r);e.href=i,e.download=n,e.click(),URL.revokeObjectURL(i)}})();function D(t){const n=t.target.files[0];if(!n)return;const l=new FileReader;l.onload=t=>{!function(t){try{for(JSON.parse(t).forEach((t=>{const n=String(t.full),l=JSON.stringify(t);e.localStorage.setItem(n,l)})),L(m);s.firstChild;)s.firstChild.remove();R(),I.counter=e.localStorage.length,w()}catch(n){console.error("Error parsing JSON:",n)}}(t.target.result)},l.readAsText(n)}f.addEventListener("click",(()=>T())),E.addEventListener("input",(()=>E.checked?s.classList.add("checks"):s.classList.remove("checks"))),d.addEventListener("input",(e=>{e.target.value.trim().length>0&&A()})),c.addEventListener("click",(()=>L(m))),a.addEventListener("click",(()=>L(y))),u.addEventListener("click",(()=>L(y))),o.addEventListener("click",(()=>x())),h.addEventListener("click",(e=>L(m))),n.addEventListener("change",(e=>D(e)),!1),d.addEventListener("keydown",(e=>function(e){const{key:t,target:n}=e,l=n.value.trim();if("Enter"===t&&l.length>0)e.preventDefault(),A(),s.children.length&&s.firstElementChild.focus();else{if("Backspace"!==t||0!==l.length)return!1;w(),A()}}(e)),!0),t.addEventListener("keydown",(e=>function(e){const{key:t}=e;return"Enter"===t||S||d.focus(),!1}(e)),!0),t.addEventListener("click",(e=>function(e){const t="create-link"===e.target.id,n="select"===e.target.id;if(!t)if(n&&!r.classList.contains("open"))r.classList.add("open"),l.style.display="block";else{if("LABEL"===e.target.tagName||"INPUT"===e.target.tagName)return;r.classList.remove("open"),l.style.display="none",B("")}}(e))),d.addEventListener("dblclick",(function(){this.value="",A()})),R()}(window,document);
